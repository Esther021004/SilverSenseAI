<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SilverSense AI</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Malgun Gothic', sans-serif;
      background: #f5f5f5;
      color: #1a1a1a;
      line-height: 1.6;
    }

    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* ìƒë‹¨ ë°” */
    .top-bar {
      background: white;
      border-bottom: 1px solid #e0e0e0;
      padding: 12px 20px;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    .top-brand {
      display: flex;
      align-items: center;
      gap: 7px;
    }

    .logo-icon {
      width: 40px;
      height: 40px;
      flex-shrink: 0;
      margin-top: 11px;
      margin-left: 7px;
    }

    .logo-text {
      display: flex;
      align-items: baseline;
    }

    .logo-text-main {
      font-size: 20px;
      font-weight: bold;
      color: #1e293b;
      letter-spacing: -0.5px;
    }

    .logo-text-ai {
      font-size: 20px;
      font-weight: bold;
      background: linear-gradient(135deg, #FF1493 0%, #A78BFA 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-left: 4px;
    }

    /* íˆì–´ë¡œ ì˜ì—­ */
    .hero {
      background: linear-gradient(135deg, #FFE5F1 0%, #E8D5FF 100%);
      padding: 60px 20px;
      text-align: center;
    }

    .hero-inner {
      max-width: 800px;
      margin: 0 auto;
    }

    .hero-title {
      font-size: 32px;
      font-weight: 700;
      line-height: 1.4;
      margin-bottom: 16px;
      color: #1a1a1a;
    }

    .accent {
      color: #764ba2;
    }

    .hero-subtitle {
      font-size: 16px;
      color: #555;
      line-height: 1.8;
    }

    /* ë©”ì¸ ì¹´ë“œ */
    .main {
      flex: 1;
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px;
      width: 100%;
    }

    .main-card {
      background: white;
      border-radius: 16px;
      padding: 32px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin-bottom: 24px;
    }

    .main-card-header {
      display: flex;
      align-items: flex-start;
      gap: 16px;
      margin-bottom: 24px;
    }

    .main-card-icon {
      font-size: 32px;
      line-height: 1;
    }

    .main-card-text h2 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #1a1a1a;
    }

    .main-card-text p {
      font-size: 14px;
      color: #666;
    }

    /* ì—…ë¡œë“œ ì˜ì—­ */
    .upload-area {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 24px;
    }

    .file-label {
      display: inline-block;
      padding: 16px 24px;
      background: #f8f9fa;
      border: 2px dashed #ccc;
      border-radius: 12px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 16px;
      color: #555;
    }

    .file-label:hover {
      background: #e9ecef;
      border-color: #A78BFA;
    }

    .file-label input[type="file"] {
      display: none;
    }

    .primary-btn {
      padding: 16px 24px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .primary-btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .primary-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .status-text {
      font-size: 14px;
      color: #666;
      margin-top: 12px;
      min-height: 20px;
    }

    /* ê°€ì´ë“œ ë°•ìŠ¤ */
    .guide-box {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 20px;
      margin-top: 24px;
    }

    .guide-box h3 {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #1a1a1a;
    }

    .guide-box ul {
      list-style: none;
      padding-left: 0;
      margin-bottom: 16px;
    }

    .guide-box ul li {
      padding: 8px 0;
      padding-left: 24px;
      position: relative;
      font-size: 14px;
      color: #555;
      line-height: 1.6;
    }

    .guide-box ul li:before {
      content: "â€¢";
      position: absolute;
      left: 8px;
      color: #A78BFA;
      font-weight: bold;
    }

    .guide-warning {
      font-size: 12px;
      color: #888;
      line-height: 1.6;
      padding-top: 12px;
      border-top: 1px solid #e0e0e0;
    }

    /* ë¡œë”© ì¹´ë“œ */
    .loading-card {
      background: white;
      border-radius: 16px;
      padding: 48px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin-bottom: 24px;
    }

    .loading-card.hidden {
      display: none;
    }

    .spinner {
      width: 48px;
      height: 48px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 24px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading-text {
      text-align: center;
    }

    .loading-title {
      font-size: 18px;
      font-weight: 600;
      color: #1a1a1a;
      margin-bottom: 8px;
    }

    .loading-sub {
      font-size: 14px;
      color: #666;
    }

    /* ê²°ê³¼ ì˜ì—­ */
    .result-wrapper {
      background: white;
      border-radius: 16px;
      padding: 32px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin-bottom: 24px;
    }

    .result-wrapper.hidden {
      display: none;
    }

    .emergency-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 2px solid #e0e0e0;
    }

    .emergency-label {
      font-size: 18px;
      font-weight: 600;
      color: #1a1a1a;
    }

    .emergency-badge {
      padding: 6px 16px;
      background: #f8f9fa;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      color: #555;
    }

    .emergency-badge.high {
      background: #fee;
      color: #c33;
    }

    .emergency-badge.medium {
      background: #fff4e6;
      color: #d97706;
    }

    .emergency-badge.low {
      background: #e6f7ff;
      color: #1890ff;
    }

    .result-summary {
      margin-bottom: 32px;
    }

    .result-summary h3 {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #1a1a1a;
    }

    .result-summary ul {
      list-style: none;
      padding-left: 0;
    }

    .result-summary ul li {
      padding: 8px 0;
      padding-left: 24px;
      position: relative;
      font-size: 14px;
      color: #555;
      line-height: 1.6;
    }

    .result-summary ul li:before {
      content: "âœ“";
      position: absolute;
      left: 8px;
      color: #A78BFA;
      font-weight: bold;
    }

    /* 3ë‹¨ê³„ ì¹´ë“œ ê·¸ë¦¬ë“œ */
    .steps-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
      margin-bottom: 32px;
    }

    .step-card {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 24px;
      border: 2px solid transparent;
      transition: all 0.3s;
    }

    .step-card:hover {
      border-color: #A78BFA;
      transform: translateY(-2px);
    }

    .step-icon {
      font-size: 32px;
      margin-bottom: 12px;
    }

    .step-card h3 {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 16px;
      color: #1a1a1a;
    }

    .step-card ul {
      list-style: none;
      padding-left: 0;
    }

    .step-card ul li {
      padding: 8px 0;
      padding-left: 20px;
      position: relative;
      font-size: 14px;
      color: #555;
      line-height: 1.6;
    }

    .step-card ul li:before {
      content: "â†’";
      position: absolute;
      left: 0;
      color: #A78BFA;
    }

    .reset-btn {
      width: 100%;
      padding: 16px;
      background: #f8f9fa;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      color: #555;
      cursor: pointer;
      transition: all 0.3s;
    }

    .reset-btn:hover {
      background: #e9ecef;
      border-color: #A78BFA;
      color: #A78BFA;
    }

    /* TTS ë²„íŠ¼ */
    .tts-controls {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 24px;
      padding: 16px;
      background: #f8f9fa;
      border-radius: 12px;
    }

    .tts-voice-select {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .tts-voice-select label {
      font-size: 14px;
      font-weight: 600;
      color: #555;
    }

    .tts-voice-select select {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      background: white;
      color: #1a1a1a;
      cursor: pointer;
    }

    .tts-voice-select select:hover {
      border-color: #A78BFA;
    }

    .tts-btn-row {
      display: flex;
      gap: 12px;
    }

    .tts-btn {
      flex: 1;
      padding: 12px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .tts-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .tts-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .tts-btn.stop {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    }

    /* ì§ˆë¬¸í•˜ê¸° ì„¹ì…˜ */
    .question-section {
      margin-top: 32px;
      padding: 24px;
      background: #f8f9fa;
      border-radius: 12px;
      border: 2px solid #e0e0e0;
    }

    .question-section h3 {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #1a1a1a;
    }

    .question-hint {
      font-size: 14px;
      color: #666;
      margin-bottom: 16px;
    }

    .text-question-input {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }

    .text-question-input input {
      flex: 1;
      padding: 12px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      color: #1a1a1a;
      transition: all 0.3s;
    }

    .text-question-input input:focus {
      outline: none;
      border-color: #A78BFA;
      box-shadow: 0 0 0 3px rgba(167, 139, 250, 0.1);
    }

    .text-question-input input::placeholder {
      color: #999;
    }

    .submit-question-btn {
      padding: 12px 24px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      white-space: nowrap;
    }

    .submit-question-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .question-controls {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .voice-question-btn {
      padding: 14px 24px;
      background: linear-gradient(135deg, #FF8FAB 0%, #A78BFA 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .voice-question-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 143, 171, 0.4);
    }

    .voice-question-btn.recording {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .question-status {
      font-size: 14px;
      color: #666;
      min-height: 20px;
      text-align: center;
    }

    .question-status.recording {
      color: #ef4444;
      font-weight: 600;
    }

    .question-answer {
      margin-top: 16px;
      padding: 16px;
      background: white;
      border-radius: 8px;
      border-left: 4px solid #A78BFA;
    }

    .question-answer.hidden {
      display: none;
    }

    .question-answer h4 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #1a1a1a;
    }

    .question-answer p {
      font-size: 14px;
      color: #555;
      line-height: 1.6;
      margin-bottom: 12px;
    }

    .question-answer .answer-actions {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }

    .answer-actions button {
      padding: 8px 16px;
      background: #f8f9fa;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .answer-actions button:hover {
      background: #e9ecef;
      border-color: #A78BFA;
    }

    /* ì˜ˆì‹œ ì„¹ì…˜ */
    .examples-section {
      max-width: 900px;
      margin: 0 auto;
      padding: 60px 20px;
      background: #f8f9fa;
    }

    .examples-section h2 {
      font-size: 28px;
      font-weight: 700;
      text-align: center;
      margin-bottom: 40px;
      color: #1a1a1a;
    }

    .examples-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 24px;
    }

    .example-card {
      background: white;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
    }

    .example-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      background: linear-gradient(180deg, #FF8FAB 0%, #A78BFA 100%);
    }

    .example-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .example-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .example-title {
      font-size: 18px;
      font-weight: 600;
      color: #1a1a1a;
    }

    .example-badge {
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
    }

    .example-badge.high {
      background: #fee;
      color: #c33;
    }

    .example-badge.medium {
      background: #fff4e6;
      color: #d97706;
    }

    .example-badge.low {
      background: #e6f7ff;
      color: #1890ff;
    }

    .example-content {
      margin-bottom: 16px;
    }

    .example-label {
      font-size: 12px;
      font-weight: 600;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
    }

    .example-input {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 12px;
      font-size: 14px;
      color: #555;
      line-height: 1.6;
      margin-bottom: 16px;
      border-left: 3px solid #A78BFA;
    }

    .example-result {
      font-size: 14px;
      color: #666;
      line-height: 1.6;
    }

    .example-result strong {
      color: #1a1a1a;
      font-weight: 600;
    }

    .example-guideline {
      background: #f0f4ff;
      border-radius: 8px;
      padding: 12px;
      font-size: 13px;
      color: #555;
      line-height: 1.6;
      margin-top: 12px;
    }

    .example-guideline strong {
      color: #A78BFA;
      font-weight: 600;
    }

    /* ì •ë³´ ì„¹ì…˜ */
    .info-section {
      max-width: 900px;
      margin: 0 auto;
      padding: 60px 20px;
    }

    .info-section h2 {
      font-size: 28px;
      font-weight: 700;
      text-align: center;
      margin-bottom: 40px;
      color: #1a1a1a;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 24px;
    }

    .info-card {
      background: white;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .info-card h3 {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #1a1a1a;
    }

    .info-card p {
      font-size: 14px;
      color: #666;
      line-height: 1.6;
    }

    /* ì¤‘ìš” ì•ˆë‚´ ì„¹ì…˜ */
    .disclaimer-section {
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px;
      text-align: center;
    }

    .disclaimer-section h2 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 16px;
      color: #1a1a1a;
    }

    .disclaimer-section p {
      font-size: 14px;
      color: #666;
      line-height: 1.8;
    }

    .disclaimer-section strong {
      color: #c33;
      font-weight: 600;
    }

    /* í‘¸í„° */
    .footer {
      background: #1a1a1a;
      color: #999;
      text-align: center;
      padding: 24px;
      font-size: 14px;
    }

    /* ë°˜ì‘í˜• */
    @media (max-width: 768px) {
      .hero-title {
        font-size: 24px;
      }

      .hero-subtitle {
        font-size: 14px;
      }

      .main-card {
        padding: 24px;
      }

      .steps-grid {
        grid-template-columns: 1fr;
      }

      .info-grid {
        grid-template-columns: 1fr;
      }

      .examples-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- ìƒë‹¨ ë°” -->
    <header class="top-bar">
      <div class="top-brand">
        <svg class="logo-icon" width="40" height="40" viewBox="0 0 80 80" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <!-- í•˜íŠ¸ ê·¸ë¼ë°ì´ì…˜ ìƒ‰ìƒ (AI í…ìŠ¤íŠ¸ì™€ ë™ì¼) -->
            <linearGradient id="heartGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#FF1493"/>
              <stop offset="100%" stop-color="#A78BFA"/>
            </linearGradient>
          </defs>
          <!-- í•˜íŠ¸ ëª¨ì–‘ -->
          <path
            d="
              M40 12
              C34 3 18 4 16 18
              C15 26 20 32 24 36
              L40 54
              L56 36
              C60 32 65 26 64 18
              C62 4 46 3 40 12
              Z
            "
            fill="url(#heartGradient)"
          />
          <!-- ì‹¬ì „ë„ + ê°€ìš´ë° ê°€ë¡œì„  (í™”ì´íŠ¸) -->
          <!-- ë’·ë°°ê²½ ê°€ë¡œì„  -->
          <path
            d="M18 30 H62"
            stroke="white"
            stroke-width="4"
            stroke-linecap="round"
          />
          <!-- ì§€ê·¸ì¬ê·¸ ì‹¬ì „ë„ ë¼ì¸ -->
          <path
            d="M20 30 L30 30 L35 24 L40 38 L46 26 L52 30 L60 30"
            stroke="white"
            stroke-width="4"
            stroke-linecap="round"
            stroke-linejoin="round"
            fill="none"
          />
        </svg>
        <div class="logo-text">
          <span class="logo-text-main">SilverSense</span>
          <span class="logo-text-ai">AI</span>
        </div>
      </div>
    </header>

    <!-- íˆì–´ë¡œ ì˜ì—­ -->
    <section class="hero">
      <div class="hero-inner">
        <h1 class="hero-title">
          í˜¼ì ê³„ì‹¤ ë•Œë„ <span class="accent">ì•ˆì‹¬í•˜ì„¸ìš”.</span><br />
          AIê°€ <span class="accent">ìœ„í—˜ ì‹ í˜¸ë¥¼ ê°ì§€í•´</span> ë°”ë¡œ ì•ˆë‚´í•©ë‹ˆë‹¤.
        </h1>
        <p class="hero-subtitle">
          SilverSense AIëŠ” ì‚¬ìš©ìì˜ ì†Œë¦¬ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë“£ê³  ìœ„í—˜ì„ ê°ì§€í•´<br />
          ëŒ€ì²˜ ë°©ë²•ì„ ì•ˆë‚´í•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.<br />
          í˜„ì¬ í”„ë¡œí† íƒ€ì…ì—ì„œëŠ” ë¸Œë¼ìš°ì € ì‹¤ì‹œê°„ ê°ì§€ê°€ ì œí•œë˜ì–´<br />
          íŒŒì¼ ì—…ë¡œë“œ ë°©ì‹ìœ¼ë¡œ ë¶„ì„í•˜ê³  ì§€ì¹¨ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.
        </p>
      </div>
    </section>

    <!-- ë©”ì¸ ì¹´ë“œ: íŒŒì¼ ì—…ë¡œë“œ -->
    <main class="main">
      <section id="main-card" class="main-card">
        <div class="main-card-header">
          <span class="main-card-icon">â¬†</span>
          <div class="main-card-text">
            <h2>ì§€ê¸ˆ ìƒí™©ì„ ì•Œë ¤ì£¼ì„¸ìš”</h2>
            <p>ì‘ê¸‰ ìƒí™©ì´ ì˜ì‹¬ë˜ëŠ” ì˜ìƒ ë˜ëŠ” ìŒì„±ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.</p>
          </div>
        </div>
        <div class="upload-area">
          <label class="file-label">
            <input type="file" id="fileInput" accept="video/*,audio/*" />
            íŒŒì¼ ì„ íƒí•˜ê¸°
          </label>
          <button id="analyzeBtn" disabled class="primary-btn">
            ìƒí™© ë¶„ì„ ì‹œì‘
          </button>
        </div>
        <p id="statusText" class="status-text"></p>

        <!-- ì–´ë–¤ íŒŒì¼ì„ ì˜¬ë¦¬ë©´ ì¢‹ì€ì§€ ê°€ì´ë“œ -->
        <div class="guide-box">
          <h3>ì–´ë–¤ íŒŒì¼ì„ ì˜¬ë¦¬ë©´ ì¢‹ì„ê¹Œìš”?</h3>
          <ul>
            <li>ì“°ëŸ¬ì§€ëŠ” ì†Œë¦¬, í° ì¶©ê²©ìŒì´ ë“¤ë¦¬ëŠ” ì˜ìƒì´ë‚˜ ìŒì„±</li>
            <li>"ë„ì™€ì£¼ì„¸ìš”", "ì“°ëŸ¬ì¡Œì–´ìš”"ì²˜ëŸ¼ ë„ì›€ì„ ìš”ì²­í•˜ëŠ” ìŒì„±</li>
            <li>10~20ì´ˆ ì •ë„ì˜ ì§§ì€ íŒŒì¼ì´ë©´ ë” ì˜ ë¶„ì„ë©ë‹ˆë‹¤.</li>
          </ul>
          <p class="guide-warning">
            â€» ì´ë¦„, ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸, ì •í™•í•œ ì§‘ ì£¼ì†Œì²˜ëŸ¼ ê°œì¸ì„ ë°”ë¡œ ì•Œì•„ë³¼ ìˆ˜ ìˆëŠ” ë‚´ìš©ì€ í¬í•¨í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì•ˆì „í•©ë‹ˆë‹¤. ì‹¤ì œ ì‹ ê³  ì‹œì—ëŠ” 119 êµ¬ì¡°ëŒ€ì›ì—ê²Œë§Œ ì£¼ì†Œë¥¼ ë§ì”€í•´ ì£¼ì„¸ìš”.
          </p>
        </div>
      </section>

      <!-- ë¡œë”© ìƒíƒœ -->
      <section id="loadingBox" class="loading-card hidden">
        <div class="spinner"></div>
        <div class="loading-text">
          <p class="loading-title">AIê°€ ì†Œë¦¬ì™€ ë§ì„ ë¶„ì„í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤â€¦</p>
          <p class="loading-sub">
            ìŒì„±ê³¼ ì£¼ë³€ ì†Œë¦¬ë¥¼ í•¨ê»˜ í™•ì¸í•˜ì—¬, ì§€ê¸ˆ í•´ì•¼ í•  í–‰ë™ì„ ì •ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.
          </p>
        </div>
      </section>

      <!-- ê²°ê³¼ ì˜ì—­: 3ë‹¨ê³„ ì¹´ë“œ -->
      <section id="resultSection" class="result-wrapper hidden">
        <div class="emergency-header">
          <span class="emergency-label">ë¶„ì„ ê²°ê³¼</span>
          <span id="emergencyLevel" class="emergency-badge">ê¸´ê¸‰ë„: -</span>
        </div>
        <div class="result-summary">
          <h3>ìƒí™© ìš”ì•½</h3>
          <ul id="summaryList"></ul>
        </div>
        <!-- TTS ì»¨íŠ¸ë¡¤ -->
        <div class="tts-controls">
          <div class="tts-voice-select">
            <label for="voiceSelect">ìŒì„± ì„ íƒ:</label>
            <select id="voiceSelect">
              <option value="auto">ìë™ ì„ íƒ (ê¶Œì¥)</option>
            </select>
          </div>
          <div class="tts-voice-select">
            <label for="rateSelect">ì½ê¸° ì†ë„:</label>
            <select id="rateSelect" onchange="console.log('ì†ë„ ë³€ê²½:', this.value)">
              <option value="0.5">ë§¤ìš° ëŠë¦¬ê²Œ</option>
              <option value="0.7">ëŠë¦¬ê²Œ</option>
              <option value="1.0" selected>ë³´í†µ</option>
              <option value="1.3">ë¹ ë¥´ê²Œ</option>
              <option value="1.7">ë§¤ìš° ë¹ ë¥´ê²Œ</option>
            </select>
          </div>
          <div class="tts-btn-row">
            <button type="button" id="ttsBtn" class="tts-btn" onclick="playTTS()">
              <span>ğŸ”Š</span>
              <span>ì§€ì¹¨ ìŒì„±ìœ¼ë¡œ ë“£ê¸°</span>
            </button>
          </div>
        </div>
        <div class="steps-grid">
          <!-- 1ë‹¨ê³„ -->
          <article class="step-card">
            <div class="step-icon">ğŸ•’</div>
            <h3>1. ì§€ê¸ˆ ë‹¹ì¥ í•´ì•¼ í•  ì¼</h3>
            <ul id="stepNow"></ul>
          </article>

          <!-- 2ë‹¨ê³„ -->
          <article class="step-card">
            <div class="step-icon">ğŸ“</div>
            <h3>2. 119 ì—°ê²°ì„ ê¸°ë‹¤ë¦¬ë©´ì„œ í•  ì¼</h3>
            <ul id="stepWait"></ul>
          </article>

          <!-- 3ë‹¨ê³„ -->
          <article class="step-card">
            <div class="step-icon">ğŸ“¢</div>
            <h3>3. 119ì— ì´ë ‡ê²Œ ë§í•˜ì„¸ìš”</h3>
            <ul id="stepCall"></ul>
          </article>
        </div>
        <!-- ì§ˆë¬¸í•˜ê¸° ì„¹ì…˜ -->
        <div class="question-section">
          <h3>ì¶”ê°€ë¡œ ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ì‹ ê°€ìš”?</h3>
          <p class="question-hint">ìŒì„± ë˜ëŠ” í…ìŠ¤íŠ¸ë¡œ ì§ˆë¬¸í•˜ì‹œë©´ AIê°€ ë‹µë³€í•´ë“œë¦½ë‹ˆë‹¤.</p>
          
          <!-- í…ìŠ¤íŠ¸ ì…ë ¥ -->
          <div class="text-question-input">
            <input 
              type="text" 
              id="textQuestionInput" 
              placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ë‹¤ë¦¬ê°€ ë„ˆë¬´ ì•„í”ˆë° ì–´ë–»ê²Œ í•´ì•¼ í•˜ë‚˜ìš”?)"
              onkeypress="if(event.key === 'Enter') submitTextQuestion()"
            />
            <button type="button" class="submit-question-btn" onclick="submitTextQuestion()">
              ì „ì†¡
            </button>
          </div>
          
          <!-- ìŒì„± ì…ë ¥ -->
          <div class="question-controls">
            <button type="button" id="voiceQuestionBtn" class="voice-question-btn" onclick="startVoiceQuestion()">
              <span>ğŸ¤</span>
              <span>ìŒì„±ìœ¼ë¡œ ì§ˆë¬¸í•˜ê¸°</span>
            </button>
            <div id="questionStatus" class="question-status"></div>
          </div>
          <div id="questionAnswer" class="question-answer hidden"></div>
        </div>
        <button type="button" class="reset-btn" onclick="resetAnalysis()">
          ë‹¤ë¥¸ ìƒí™© ë¶„ì„í•˜ê¸°
        </button>
      </section>
    </main>

    <!-- ìƒí™©ë³„ ì˜ˆì‹œ ì„¹ì…˜ -->
    <section class="examples-section">
      <h2>ì´ëŸ° ìƒí™©ì—ì„œ ë„ì›€ì´ ë©ë‹ˆë‹¤</h2>
      <div class="examples-grid">
        <!-- ì˜ˆì‹œ 1: ë‚™ìƒ + ì‹¬ì •ì§€ -->
        <article class="example-card high">
          <div class="example-header">
            <h3 class="example-title">ë‚™ìƒ í›„ ì˜ì‹ ì†Œì‹¤</h3>
            <span class="example-badge high">ê¸´ê¸‰ë„: ë†’ìŒ</span>
          </div>
          <div class="example-content">
            <div class="example-label">ì…ë ¥ ì˜ˆì‹œ</div>
            <div class="example-input">
              <strong>ìŒì„±:</strong> "í• ë¨¸ë‹ˆê°€ ê°‘ìê¸° ì“°ëŸ¬ì ¸ì„œ ìˆ¨ì„ ì•ˆ ì‰¬ì–´ìš”..."<br />
              <strong>ì†Œë¦¬:</strong> í° ì¶©ê²©ìŒ (ë‚™ìƒ ê°ì§€)
            </div>
            <div class="example-result">
              <strong>ë¶„ì„ ê²°ê³¼:</strong> S2 ìƒí™© (ë‚™ìƒ + ìƒëª…ìœ„í˜‘)<br />
              <strong>ê°ì§€ëœ ì¦ìƒ:</strong> fall, possible_cardiac_arrest, not_breathing
            </div>
            <div class="example-guideline">
              <strong>ì œê³µë˜ëŠ” ì§€ì¹¨:</strong> ì¦‰ì‹œ 119 ì‹ ê³  â†’ ì „í™” ì—°ê²° ëŒ€ê¸° ì¤‘ ìì„¸ ì¡°ì • â†’ ì‹ ê³  ë©˜íŠ¸ ì•ˆë‚´
            </div>
          </div>
        </article>

        <!-- ì˜ˆì‹œ 2: í˜¸í¡ê³¤ë€ -->
        <article class="example-card high">
          <div class="example-header">
            <h3 class="example-title">í˜¸í¡ê³¤ë€</h3>
            <span class="example-badge high">ê¸´ê¸‰ë„: ë†’ìŒ</span>
          </div>
          <div class="example-content">
            <div class="example-label">ì…ë ¥ ì˜ˆì‹œ</div>
            <div class="example-input">
              <strong>ìŒì„±:</strong> "ìˆ¨ì‰¬ê¸°ê°€ ë„ˆë¬´ í˜ë“¤ì–´ìš”... ê°€ìŠ´ì´ ë‹µë‹µí•´ìš”"<br />
              <strong>ì†Œë¦¬:</strong> ìƒí™œì†ŒìŒ
            </div>
            <div class="example-result">
              <strong>ë¶„ì„ ê²°ê³¼:</strong> S6 ìƒí™© (ê³ ìœ„í—˜ ì˜ë£Œì‘ê¸‰)<br />
              <strong>ê°ì§€ëœ ì¦ìƒ:</strong> breathing_difficulty, high_urgency
            </div>
            <div class="example-guideline">
              <strong>ì œê³µë˜ëŠ” ì§€ì¹¨:</strong> 119 ì‹ ê³  â†’ ë°˜ì¢Œìœ„ ìì„¸, ì˜· í’€ê¸° â†’ ì‹ ê³  ë©˜íŠ¸ ì•ˆë‚´
            </div>
          </div>
        </article>

        <!-- ì˜ˆì‹œ 3: í™”ì¬ -->
        <article class="example-card high">
          <div class="example-header">
            <h3 class="example-title">í™”ì¬ / ì—°ê¸° ê°ì§€</h3>
            <span class="example-badge high">ê¸´ê¸‰ë„: ë†’ìŒ</span>
          </div>
          <div class="example-content">
            <div class="example-label">ì…ë ¥ ì˜ˆì‹œ</div>
            <div class="example-input">
              <strong>ìŒì„±:</strong> "ë¶ˆì´ ë‚¬ì–´ìš”! ì—°ê¸°ê°€ ë‚˜ê³  ìˆì–´ìš”!"<br />
              <strong>ì†Œë¦¬:</strong> í™”ì¬ ê°ì§€
            </div>
            <div class="example-result">
              <strong>ë¶„ì„ ê²°ê³¼:</strong> S4 ìƒí™© (í™”ì¬)<br />
              <strong>ê°ì§€ëœ ì¦ìƒ:</strong> fire_suspected, high_urgency
            </div>
            <div class="example-guideline">
              <strong>ì œê³µë˜ëŠ” ì§€ì¹¨:</strong> ì¦‰ì‹œ 119 ì‹ ê³  â†’ ë‚®ì€ ìì„¸, ì½”Â·ì… ë§‰ê¸° â†’ ëŒ€í”¼ë¡œ í™•ë³´ ì•ˆë‚´
            </div>
          </div>
        </article>

        <!-- ì˜ˆì‹œ 4: ë‚™ìƒ + ë¶€ìƒ -->
        <article class="example-card medium">
          <div class="example-header">
            <h3 class="example-title">ë‚™ìƒ í›„ ë¶€ìƒ</h3>
            <span class="example-badge medium">ê¸´ê¸‰ë„: ë³´í†µ</span>
          </div>
          <div class="example-content">
            <div class="example-label">ì…ë ¥ ì˜ˆì‹œ</div>
            <div class="example-input">
              <strong>ìŒì„±:</strong> "ë„˜ì–´ì¡ŒëŠ”ë° ë‹¤ë¦¬ê°€ ë„ˆë¬´ ì•„íŒŒìš”..."<br />
              <strong>ì†Œë¦¬:</strong> í° ì¶©ê²©ìŒ (ë‚™ìƒ ê°ì§€)
            </div>
            <div class="example-result">
              <strong>ë¶„ì„ ê²°ê³¼:</strong> S3 ìƒí™© (ë‚™ìƒ + ë¶€ìƒ)<br />
              <strong>ê°ì§€ëœ ì¦ìƒ:</strong> fall, possible_fracture
            </div>
            <div class="example-guideline">
              <strong>ì œê³µë˜ëŠ” ì§€ì¹¨:</strong> 119 ì‹ ê³  â†’ ì›€ì§ì„ ìµœì†Œí™” â†’ ì‹ ê³  ë©˜íŠ¸ ì•ˆë‚´
            </div>
          </div>
        </article>

        <!-- ì˜ˆì‹œ 5: í‰í†µ -->
        <article class="example-card medium">
          <div class="example-header">
            <h3 class="example-title">ê°€ìŠ´ í†µì¦</h3>
            <span class="example-badge medium">ê¸´ê¸‰ë„: ë³´í†µ</span>
          </div>
          <div class="example-content">
            <div class="example-label">ì…ë ¥ ì˜ˆì‹œ</div>
            <div class="example-input">
              <strong>ìŒì„±:</strong> "ê°€ìŠ´ì´ ë„ˆë¬´ ì•„í”„ê³  ìˆ¨ì‰¬ê¸°ê°€ ì¡°ê¸ˆ í˜ë“¤ì–´ìš”"<br />
              <strong>ì†Œë¦¬:</strong> ìƒí™œì†ŒìŒ
            </div>
            <div class="example-result">
              <strong>ë¶„ì„ ê²°ê³¼:</strong> S1 ìƒí™© (ì˜ë£Œ ì‘ê¸‰)<br />
              <strong>ê°ì§€ëœ ì¦ìƒ:</strong> chest_pain, breathing_difficulty
            </div>
            <div class="example-guideline">
              <strong>ì œê³µë˜ëŠ” ì§€ì¹¨:</strong> ì¦ìƒ í™•ì¸ â†’ í•„ìš”ì‹œ 119 ì‹ ê³  â†’ í¸ì•ˆí•œ ìì„¸, ì˜· í’€ê¸° ì•ˆë‚´
            </div>
          </div>
        </article>

        <!-- ì˜ˆì‹œ 6: ê°‡í˜ -->
        <article class="example-card medium">
          <div class="example-header">
            <h3 class="example-title">ê°‡í˜ / ê³ ë¦½</h3>
            <span class="example-badge medium">ê¸´ê¸‰ë„: ë³´í†µ</span>
          </div>
          <div class="example-content">
            <div class="example-label">ì…ë ¥ ì˜ˆì‹œ</div>
            <div class="example-input">
              <strong>ìŒì„±:</strong> "ë¬¸ì´ ì•ˆ ì—´ë ¤ìš”... ë‚˜ê°ˆ ìˆ˜ê°€ ì—†ì–´ìš”"<br />
              <strong>ì†Œë¦¬:</strong> ê°‡í˜ ê°ì§€
            </div>
            <div class="example-result">
              <strong>ë¶„ì„ ê²°ê³¼:</strong> S5 ìƒí™© (ê°‡í˜ / ê³ ë¦½)<br />
              <strong>ê°ì§€ëœ ì¦ìƒ:</strong> trapped_or_confined
            </div>
            <div class="example-guideline">
              <strong>ì œê³µë˜ëŠ” ì§€ì¹¨:</strong> 119 ì‹ ê³  â†’ ì•ˆì „í•œ ìœ„ì¹˜ ìœ ì§€ â†’ ì‹ ê³  ë©˜íŠ¸ ì•ˆë‚´
            </div>
          </div>
        </article>
      </div>
    </section>

    <!-- ì„œë¹„ìŠ¤ ì†Œê°œ / ë™ì‘ ì›ë¦¬ ì„¹ì…˜ -->
    <section class="info-section">
      <h2>SilverSense AIëŠ” ì›ë˜ ì´ë ‡ê²Œ ë™ì‘í•©ë‹ˆë‹¤</h2>
      <div class="info-grid">
        <article class="info-card">
          <h3>ì‹¤ì‹œê°„ ìœ„í—˜ ê°ì§€</h3>
          <p>
            SilverSense AIëŠ” ì‚¬ìš©ìì˜ ìŒì„±Â·í™˜ê²½ ì†Œë¦¬ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë“£ê³ ,
            ë‚™ìƒ ì†Œë¦¬, ë„ì›€ ìš”ì²­, í˜¸í¡ê³¤ë€ ìŒì„± ë“± ìœ„í—˜ ì‹ í˜¸ë¥¼
            ì¦‰ì‹œ ê°ì§€í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
          </p>
        </article>
        <article class="info-card">
          <h3>ì¦‰ì‹œ ëŒ€ì²˜ ì•ˆë‚´</h3>
          <p>
            ìœ„í—˜ì´ ê°ì§€ë˜ë©´ ë°”ë¡œ í•´ì•¼ í•  ì¼,
            119 ì—°ê²° ëŒ€ê¸° ì¤‘ í•´ì•¼ í•  ì¼,
            119ì— ì–´ë–»ê²Œ ë§í•´ì•¼ í•˜ëŠ”ì§€ ë‹¨ê³„ë³„ë¡œ ì•ˆë‚´í•©ë‹ˆë‹¤.
          </p>
        </article>
        <article class="info-card">
          <h3>í”„ë¡œí† íƒ€ì… ì‘ë™ ë°©ì‹</h3>
          <p>
            í˜„ì¬ ì›¹ì—ì„œëŠ” ì‹¤ì‹œê°„ ë§ˆì´í¬ ì—°ë™ê³¼ ì§€ì† ê°ì‹œê°€ ì–´ë µê¸° ë•Œë¬¸ì—,
            <strong>íŒŒì¼ ì—…ë¡œë“œ ë°©ì‹ìœ¼ë¡œ</strong> ìƒí™©ì„ ë¶„ì„í•˜ê³  ë™ì¼í•œ
            ìœ„í—˜ íŒë‹¨ ë¡œì§ê³¼ ì§€ì¹¨ ìƒì„± ì‹œìŠ¤í…œì„ ì ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.
          </p>
        </article>
      </div>
    </section>

    <section class="disclaimer-section">
      <h2>ì¤‘ìš” ì•ˆë‚´</h2>
      <p>
        SilverSense AIëŠ” ì‘ê¸‰ ìƒí™©ì„ ë” ì˜ ì´í•´í•˜ëŠ” ë° ë„ì›€ì„ ì£¼ëŠ”
        <strong>ë³´ì¡° ë„êµ¬</strong>ì…ë‹ˆë‹¤.<br />
        ì‹¤ì œ ìƒëª… ìœ„í˜‘ì´ ëŠê»´ì§ˆ ê²½ìš°, ì•ˆë‚´ ë‚´ìš©ê³¼ ìƒê´€ì—†ì´
        <strong>í•­ìƒ 119ì— ë°”ë¡œ ì‹ ê³ </strong>í•´ ì£¼ì„¸ìš”.
      </p>
    </section>

    <footer class="footer">
      SilverSense AI Â· ì‘ê¸‰ ìƒí™© ëŒ€ì‘ í”„ë¡œí† íƒ€ì…
    </footer>
  </div>

  <script>
    // API URL ìë™ ê°ì§€
    const urlParams = new URLSearchParams(window.location.search);
    const API_BASE_URL = urlParams.get('api') || window.location.origin;
    console.log('API ì„œë²„ URL:', API_BASE_URL);

    // DOM ìš”ì†Œ
    const fileInput = document.getElementById('fileInput');
    const analyzeBtn = document.getElementById('analyzeBtn');
    const statusText = document.getElementById('statusText');
    const loadingBox = document.getElementById('loadingBox');
    const resultSection = document.getElementById('resultSection');
    const mainCard = document.getElementById('main-card');

    // íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸
    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        statusText.textContent = `ì„ íƒëœ íŒŒì¼: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`;
        analyzeBtn.disabled = false;
      } else {
        analyzeBtn.disabled = true;
        statusText.textContent = '';
      }
    });

    // ë¶„ì„ ì‹œì‘ ë²„íŠ¼
    analyzeBtn.addEventListener('click', () => {
      const file = fileInput.files[0];
      if (file) {
        analyzeFile(file);
      }
    });

    // ë“œë˜ê·¸ ì•¤ ë“œë¡­
    const uploadArea = document.querySelector('.upload-area');
    
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.style.background = '#f0f0f0';
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.style.background = '';
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.style.background = '';
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        fileInput.files = files;
        fileInput.dispatchEvent(new Event('change'));
      }
    });

    // íŒŒì¼ ë¶„ì„ í•¨ìˆ˜
    async function analyzeFile(file) {
      // UI ìƒíƒœ ë³€ê²½
      mainCard.style.opacity = '0.6';
      mainCard.style.pointerEvents = 'none';
      analyzeBtn.disabled = true;
      loadingBox.classList.remove('hidden');
      resultSection.classList.add('hidden');
      statusText.textContent = 'ë¶„ì„ ì¤‘...';

      const formData = new FormData();
      formData.append('file', file);

      try {
        const response = await fetch(`${API_BASE_URL}/api/emergency/analyze-video`, {
          method: 'POST',
          body: formData
        });

        if (!response.ok) {
          const errorData = await response.json().catch(() => ({ detail: 'ìš”ì²­ ì‹¤íŒ¨' }));
          throw new Error(errorData.detail || `HTTP ì˜¤ë¥˜: ${response.status}`);
        }

        const data = await response.json();
        displayResult(data);
      } catch (err) {
        statusText.textContent = 'ì˜¤ë¥˜ ë°œìƒ: ' + err.message;
        statusText.style.color = '#c33';
        loadingBox.classList.add('hidden');
        mainCard.style.opacity = '1';
        mainCard.style.pointerEvents = 'auto';
        analyzeBtn.disabled = false;
      }
    }

    // ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
    function displayResult(data) {
      const { situation, guideline } = data;

      // í˜„ì¬ ìƒí™© ì •ë³´ ì €ì¥ (ì§ˆë¬¸-ë‹µë³€ì— ì‚¬ìš©)
      currentSituation = situation;

      // ê¸´ê¸‰ë„ í‘œì‹œ
      const emergencyLevel = document.getElementById('emergencyLevel');
      const level = situation?.emergency_level || 'unknown';
      emergencyLevel.textContent = `ê¸´ê¸‰ë„: ${level === 'high' ? 'ë†’ìŒ' : level === 'medium' ? 'ë³´í†µ' : 'ë‚®ìŒ'}`;
      emergencyLevel.className = 'emergency-badge ' + level;

      // ìƒí™© ìš”ì•½
      const summaryList = document.getElementById('summaryList');
      summaryList.innerHTML = '';
      if (situation?.symptoms && situation.symptoms.length > 0) {
        situation.symptoms.forEach(symptom => {
          const li = document.createElement('li');
          li.textContent = symptom;
          summaryList.appendChild(li);
        });
      } else {
        const li = document.createElement('li');
        li.textContent = 'ìƒí™© ë¶„ì„ ì™„ë£Œ';
        summaryList.appendChild(li);
      }

      // ì§€ì¹¨ íŒŒì‹±
      parseGuideline(guideline);

      // ê²°ê³¼ í‘œì‹œ
      loadingBox.classList.add('hidden');
      resultSection.classList.remove('hidden');
      mainCard.style.opacity = '1';
      mainCard.style.pointerEvents = 'auto';
      statusText.textContent = 'ë¶„ì„ ì™„ë£Œ';
      statusText.style.color = '#666';

      // ê²°ê³¼ ì˜ì—­ìœ¼ë¡œ ìŠ¤í¬ë¡¤
      resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // ì§€ì¹¨ íŒŒì‹± í•¨ìˆ˜
    function parseGuideline(guideline) {
      const stepNow = document.getElementById('stepNow');
      const stepWait = document.getElementById('stepWait');
      const stepCall = document.getElementById('stepCall');

      // ì´ˆê¸°í™”
      stepNow.innerHTML = '';
      stepWait.innerHTML = '';
      stepCall.innerHTML = '';

      const lines = guideline.split('\n');
      let currentStep = null;
      let currentList = null;

      for (let i = 0; i < lines.length; i++) {
        const line = lines[i].trim();
        if (!line) continue;

        // ë‹¨ê³„ ê°ì§€
        if (line.includes('**1ë‹¨ê³„') || line.includes('1ë‹¨ê³„:') || line.includes('**1.') || line.includes('1.')) {
          currentStep = 'now';
          currentList = stepNow;
        } else if (line.includes('**2ë‹¨ê³„') || line.includes('2ë‹¨ê³„:') || line.includes('**2.') || line.includes('2.')) {
          currentStep = 'wait';
          currentList = stepWait;
        } else if (line.includes('**3ë‹¨ê³„') || line.includes('3ë‹¨ê³„:') || line.includes('**3.') || line.includes('3.')) {
          currentStep = 'call';
          currentList = stepCall;
        } else if (currentList && (line.startsWith('- ') || line.startsWith('â€¢ ') || line.startsWith('* '))) {
          // ë¦¬ìŠ¤íŠ¸ í•­ëª©
          const li = document.createElement('li');
          li.textContent = line.replace(/^[-â€¢*]\s+/, '').trim();
          currentList.appendChild(li);
        } else if (currentList && line.length > 10 && !line.includes('**') && !line.includes('ë‹¨ê³„')) {
          // ì¼ë°˜ í…ìŠ¤íŠ¸ë„ ë¦¬ìŠ¤íŠ¸ë¡œ ì¶”ê°€
          const li = document.createElement('li');
          li.textContent = line.trim();
          currentList.appendChild(li);
        }
      }

      // ê¸°ë³¸ê°’ (íŒŒì‹± ì‹¤íŒ¨ ì‹œ)
      if (stepNow.children.length === 0) {
        stepNow.innerHTML = '<li>ì‘ê¸‰ ìƒí™© ë¶„ì„ í›„ ê°€ì¥ ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ í–‰ë™ ì§€ì¹¨ì´ í‘œì‹œë©ë‹ˆë‹¤.</li>';
      }
      if (stepWait.children.length === 0) {
        stepWait.innerHTML = '<li>119 ì‹ ê³  í›„ ëŒ€ê¸° ì¤‘ í•  ìˆ˜ ìˆëŠ” ì‘ê¸‰ì²˜ì¹˜ ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.</li>';
      }
      if (stepCall.children.length === 0) {
        stepCall.innerHTML = '<li>ìƒí™©ì— ë§ëŠ” êµ¬ì²´ì ì¸ ì‹ ê³  ë©˜íŠ¸ë¥¼ ì œì‹œí•©ë‹ˆë‹¤.</li>';
      }
    }

    // TTS ê´€ë ¨ ë³€ìˆ˜
    let speechSynthesis = window.speechSynthesis;
    let currentUtterance = null;
    let isPlaying = false;

    // TTS ì¬ìƒ í•¨ìˆ˜
    function playTTS() {
      const ttsBtn = document.getElementById('ttsBtn');
      
      // ì´ë¯¸ ì¬ìƒ ì¤‘ì´ë©´ ì •ì§€
      if (isPlaying) {
        stopTTS();
        return;
      }

      // ì§€ì¹¨ í…ìŠ¤íŠ¸ ìˆ˜ì§‘
      const stepNow = document.getElementById('stepNow');
      const stepWait = document.getElementById('stepWait');
      const stepCall = document.getElementById('stepCall');

      let fullText = 'ì§€ê¸ˆ ìƒí™©ì´ ë¶ˆì•ˆí•˜ì‹œê² ì§€ë§Œ, ì²œì²œíˆ ë”°ë¼í•´ ì£¼ì„¸ìš”. í•˜ë‚˜ì”© ì•ˆë‚´í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ';

      // 1ë‹¨ê³„
      if (stepNow.children.length > 0) {
        fullText += 'ë¨¼ì €, ì§€ê¸ˆ ë‹¹ì¥ í•´ì•¼ í•  ì¼ì…ë‹ˆë‹¤. ';
        const items = Array.from(stepNow.children);
        items.forEach((li, index) => {
          if (index === 0) {
            fullText += li.textContent + '. ';
          } else {
            fullText += 'ê·¸ë¦¬ê³ , ' + li.textContent + '. ';
          }
        });
        fullText += 'ì˜ í•˜ê³  ê³„ì‹­ë‹ˆë‹¤. ';
      }

      // 2ë‹¨ê³„
      if (stepWait.children.length > 0) {
        fullText += 'ì´ì œ, 119ì— ì „í™”ë¥¼ ê±¸ê³  ì—°ê²°ì„ ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆ í•  ìˆ˜ ìˆëŠ” ì¼ì…ë‹ˆë‹¤. ';
        const items = Array.from(stepWait.children);
        items.forEach((li, index) => {
          if (index === 0) {
            fullText += li.textContent + '. ';
          } else {
            fullText += 'ë˜í•œ, ' + li.textContent + '. ';
          }
        });
        fullText += 'ê´œì°®ìŠµë‹ˆë‹¤, ì²œì²œíˆ í•˜ì„¸ìš”. ';
      }

      // 3ë‹¨ê³„
      if (stepCall.children.length > 0) {
        fullText += 'ë§ˆì§€ë§‰ìœ¼ë¡œ, 119ì— ì „í™”ê°€ ì—°ê²°ë˜ë©´ ì´ë ‡ê²Œ ë§ì”€í•˜ì‹œë©´ ë©ë‹ˆë‹¤. ';
        const items = Array.from(stepCall.children);
        items.forEach((li, index) => {
          if (index === 0) {
            fullText += li.textContent + '. ';
          } else {
            fullText += 'ê·¸ë¦¬ê³ , ' + li.textContent + '. ';
          }
        });
        fullText += 'ê±±ì •í•˜ì§€ ë§ˆì„¸ìš”, êµ¬ì¡°ëŒ€ì›ë“¤ì´ ë„ì™€ë“œë¦´ ê±°ì˜ˆìš”. ';
      }

      fullText += 'ì§€ì¹¨ ì•ˆë‚´ë¥¼ ë§ˆì³¤ìŠµë‹ˆë‹¤. í˜¼ì ê³„ì‹œë”ë¼ë„ ê´œì°®ìŠµë‹ˆë‹¤. ';

      // "119"ë¥¼ "ì¼ì¼êµ¬"ë¡œ ì¹˜í™˜ (TTSê°€ ì˜¬ë°”ë¥´ê²Œ ì½ë„ë¡)
      fullText = fullText.replace(/119/g, 'ì¼ì¼êµ¬');

      // SpeechSynthesisë¡œ ìŒì„± ì¬ìƒ
      if (speechSynthesis) {
        // ê¸°ì¡´ ì¬ìƒ ì™„ì „íˆ ì¤‘ì§€
        if (isPlaying || speechSynthesis.speaking) {
          speechSynthesis.cancel();
          isPlaying = false;
          // ìƒíƒœ ì´ˆê¸°í™”ë¥¼ ìœ„í•´ ì§§ì€ ì§€ì—°
          setTimeout(() => {
            startTTSPlayback(fullText);
          }, 100);
          return;
        }
        
        startTTSPlayback(fullText);
      }
    }

    // TTS ì¬ìƒ ì‹œì‘ í•¨ìˆ˜ (ë¶„ë¦¬)
    function startTTSPlayback(fullText) {
      if (!speechSynthesis) return;
      
      // ì„ íƒëœ ì†ë„ ê°€ì ¸ì˜¤ê¸°
      const rateSelect = document.getElementById('rateSelect');
      if (!rateSelect) {
        console.error('rateSelect ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      
      const selectedRate = parseFloat(rateSelect.value);
      if (isNaN(selectedRate)) {
        console.error('ì†ë„ ê°’ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤:', rateSelect.value);
        return;
      }
      
      console.log('ì„ íƒëœ ì†ë„:', selectedRate, 'ì›ë³¸ ê°’:', rateSelect.value);
      
      currentUtterance = new SpeechSynthesisUtterance(fullText);
      currentUtterance.lang = 'ko-KR'; // í•œêµ­ì–´ ì„¤ì •
      currentUtterance.rate = selectedRate; // ì†ë„ (0.1 ~ 10)
      currentUtterance.pitch = 1.1; // ìŒë†’ì´ (ì•½ê°„ ë†’ì—¬ì„œ ë” ë”°ëœ»í•˜ê²Œ)
      currentUtterance.volume = 1; // ë³¼ë¥¨ (0 ~ 1, ê¸°ë³¸ê°’ 1)
      
      console.log('TTS ì†ë„ ì„¤ì • ì™„ë£Œ:', currentUtterance.rate);

      // ì„ íƒëœ ìŒì„± ì‚¬ìš©
      const voiceSelect = document.getElementById('voiceSelect');
      const selectedVoiceIndex = voiceSelect.value;

      if (selectedVoiceIndex === 'auto') {
        // ìë™ ì„ íƒ: í•œêµ­ì–´ ìŒì„± ì°¾ê¸°
        const voices = speechSynthesis.getVoices();
        const koreanVoice = voices.find(voice => 
          voice.lang.includes('ko') || voice.lang.includes('KR')
        );
        if (koreanVoice) {
          currentUtterance.voice = koreanVoice;
        }
      } else {
        // ì‚¬ìš©ìê°€ ì„ íƒí•œ ìŒì„± ì‚¬ìš©
        const selectedVoice = availableVoices[parseInt(selectedVoiceIndex)];
        if (selectedVoice) {
          currentUtterance.voice = selectedVoice;
        }
      }

      // ì¬ìƒ ì‹œì‘
      const ttsBtn = document.getElementById('ttsBtn');
      currentUtterance.onstart = () => {
        isPlaying = true;
        ttsBtn.innerHTML = '<span>â¸</span><span>ì¬ìƒ ì¤‘ì§€</span>';
        ttsBtn.classList.add('stop');
      };

      // ì¬ìƒ ì¢…ë£Œ
      currentUtterance.onend = () => {
        isPlaying = false;
        ttsBtn.innerHTML = '<span>ğŸ”Š</span><span>ì§€ì¹¨ ìŒì„±ìœ¼ë¡œ ë“£ê¸°</span>';
        ttsBtn.classList.remove('stop');
      };

      // ì˜¤ë¥˜ ì²˜ë¦¬
      currentUtterance.onerror = (event) => {
        // 'interrupted' ì˜¤ë¥˜ëŠ” ë¬´ì‹œ (ì‚¬ìš©ìê°€ ì¤‘ì§€í•œ ê²½ìš°)
        if (event.error === 'interrupted') {
          console.log('TTS ì¬ìƒì´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.');
          isPlaying = false;
          ttsBtn.innerHTML = '<span>ğŸ”Š</span><span>ì§€ì¹¨ ìŒì„±ìœ¼ë¡œ ë“£ê¸°</span>';
          ttsBtn.classList.remove('stop');
          return;
        }
        
        console.error('TTS ì˜¤ë¥˜:', event.error);
        isPlaying = false;
        ttsBtn.innerHTML = '<span>ğŸ”Š</span><span>ì§€ì¹¨ ìŒì„±ìœ¼ë¡œ ë“£ê¸°</span>';
        ttsBtn.classList.remove('stop');
        
        // ì‹¬ê°í•œ ì˜¤ë¥˜ë§Œ ì•Œë¦¼
        if (event.error !== 'canceled') {
          alert('ìŒì„± ì¬ìƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + event.error);
        }
      };

      speechSynthesis.speak(currentUtterance);
    }

    // TTS ì •ì§€ í•¨ìˆ˜
    function stopTTS() {
      if (speechSynthesis && isPlaying) {
        speechSynthesis.cancel();
        isPlaying = false;
        const ttsBtn = document.getElementById('ttsBtn');
        ttsBtn.innerHTML = '<span>ğŸ”Š</span><span>ì§€ì¹¨ ìŒì„±ìœ¼ë¡œ ë“£ê¸°</span>';
        ttsBtn.classList.remove('stop');
      }
    }


    // ìŒì„± ì§ˆë¬¸ ê´€ë ¨ ë³€ìˆ˜
    let recognition = null;
    let currentSituation = null; // í˜„ì¬ ë¶„ì„ëœ ìƒí™© ì •ë³´ ì €ì¥

    // ìŒì„± ì¸ì‹ ì´ˆê¸°í™”
    function initSpeechRecognition() {
      if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        recognition.lang = 'ko-KR';
        recognition.continuous = false;
        recognition.interimResults = false;

        recognition.onresult = (event) => {
          const transcript = event.results[0][0].transcript;
          handleQuestion(transcript);
        };

        recognition.onerror = (event) => {
          console.error('ìŒì„± ì¸ì‹ ì˜¤ë¥˜:', event.error);
          const questionStatus = document.getElementById('questionStatus');
          if (questionStatus) {
            questionStatus.textContent = 'ìŒì„± ì¸ì‹ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
            questionStatus.style.color = '#ef4444';
          }
          stopVoiceRecording();
        };

        recognition.onend = () => {
          stopVoiceRecording();
        };
      } else {
        console.warn('ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
      }
    }

    // ìŒì„± ì§ˆë¬¸ ì‹œì‘
    function startVoiceQuestion() {
      if (!recognition) {
        initSpeechRecognition();
      }

      if (!recognition) {
        alert('ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Chrome ë˜ëŠ” Edgeë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.');
        return;
      }

      if (!currentSituation) {
        alert('ë¨¼ì € ìƒí™©ì„ ë¶„ì„í•´ì£¼ì„¸ìš”.');
        return;
      }

      const voiceQuestionBtn = document.getElementById('voiceQuestionBtn');
      const questionStatus = document.getElementById('questionStatus');

      if (recognition && recognition.isListening) {
        // ì´ë¯¸ ë…¹ìŒ ì¤‘ì´ë©´ ì¤‘ì§€
        recognition.stop();
        return;
      }

      try {
        recognition.start();
        voiceQuestionBtn.classList.add('recording');
        voiceQuestionBtn.innerHTML = '<span>â¹</span><span>ë…¹ìŒ ì¤‘ì§€</span>';
        questionStatus.textContent = 'ğŸ¤ ë§ì”€í•´ì£¼ì„¸ìš”...';
        questionStatus.classList.add('recording');
      } catch (error) {
        console.error('ìŒì„± ì¸ì‹ ì‹œì‘ ì˜¤ë¥˜:', error);
        questionStatus.textContent = 'ìŒì„± ì¸ì‹ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë§ˆì´í¬ ê¶Œí•œì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
        questionStatus.style.color = '#ef4444';
      }
    }

    // ìŒì„± ë…¹ìŒ ì¤‘ì§€
    function stopVoiceRecording() {
      if (recognition && recognition.isListening) {
        recognition.stop();
      }

      const voiceQuestionBtn = document.getElementById('voiceQuestionBtn');
      const questionStatus = document.getElementById('questionStatus');

      if (voiceQuestionBtn) {
        voiceQuestionBtn.classList.remove('recording');
        voiceQuestionBtn.innerHTML = '<span>ğŸ¤</span><span>ìŒì„±ìœ¼ë¡œ ì§ˆë¬¸í•˜ê¸°</span>';
      }
      if (questionStatus) {
        questionStatus.textContent = '';
        questionStatus.classList.remove('recording');
      }
    }

    // í…ìŠ¤íŠ¸ ì§ˆë¬¸ ì œì¶œ
    function submitTextQuestion() {
      const textInput = document.getElementById('textQuestionInput');
      if (!textInput) return;

      const questionText = textInput.value.trim();
      if (!questionText) {
        alert('ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      if (!currentSituation) {
        alert('ë¨¼ì € ìƒí™©ì„ ë¶„ì„í•´ì£¼ì„¸ìš”.');
        return;
      }

      // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
      textInput.value = '';
      
      // ì§ˆë¬¸ ì²˜ë¦¬
      handleQuestion(questionText);
    }

    // ì§ˆë¬¸ ì²˜ë¦¬
    async function handleQuestion(questionText) {
      const questionStatus = document.getElementById('questionStatus');
      const questionAnswer = document.getElementById('questionAnswer');

      if (questionStatus) {
        questionStatus.textContent = 'ì§ˆë¬¸ì„ ì²˜ë¦¬í•˜ëŠ” ì¤‘...';
        questionStatus.style.color = '#666';
      }

      try {
        const response = await fetch(`${API_BASE_URL}/api/emergency/ask`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            question: questionText,
            situation: currentSituation
          })
        });

        if (!response.ok) {
          throw new Error(`HTTP ì˜¤ë¥˜: ${response.status}`);
        }

        const data = await response.json();
        const answer = data.answer;

        // ë‹µë³€ í‘œì‹œ
        if (questionAnswer) {
          questionAnswer.innerHTML = `
            <h4>ì§ˆë¬¸: ${questionText}</h4>
            <p>${answer.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</p>
            <div class="answer-actions">
              <button onclick="speakAnswer('${answer.replace(/'/g, "\\'").replace(/"/g, '&quot;')}')">ğŸ”Š ë‹µë³€ ë“£ê¸°</button>
              <button onclick="document.getElementById('questionAnswer').classList.add('hidden')">ë‹«ê¸°</button>
            </div>
          `;
          questionAnswer.classList.remove('hidden');
        }
        
        if (questionStatus) {
          questionStatus.textContent = 'ë‹µë³€ì„ ë°›ì•˜ìŠµë‹ˆë‹¤.';
          questionStatus.style.color = '#666';
        }

        // ìë™ìœ¼ë¡œ ë‹µë³€ ì½ì–´ì£¼ê¸°
        setTimeout(() => {
          speakAnswer(answer);
        }, 500);

      } catch (error) {
        console.error('ì§ˆë¬¸ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
        if (questionStatus) {
          questionStatus.textContent = 'ë‹µë³€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
          questionStatus.style.color = '#ef4444';
        }
      }
    }

    // ë‹µë³€ì„ TTSë¡œ ì½ì–´ì£¼ê¸°
    function speakAnswer(text) {
      if (!speechSynthesis) return;

      // "119"ë¥¼ "ì¼ì¼êµ¬"ë¡œ ì¹˜í™˜
      const textToSpeak = text.replace(/119/g, 'ì¼ì¼êµ¬');

      const utterance = new SpeechSynthesisUtterance(textToSpeak);
      utterance.lang = 'ko-KR';
      
      // ì„ íƒëœ ì†ë„ ì‚¬ìš©
      const rateSelect = document.getElementById('rateSelect');
      if (rateSelect) {
        utterance.rate = parseFloat(rateSelect.value) || 0.85;
      } else {
        utterance.rate = 0.85;
      }
      
      utterance.pitch = 1.1;
      utterance.volume = 1;

      // í•œêµ­ì–´ ìŒì„± ì„ íƒ
      const voices = speechSynthesis.getVoices();
      const koreanVoice = voices.find(voice => 
        voice.lang.includes('ko') || voice.lang.includes('KR')
      );
      if (koreanVoice) {
        utterance.voice = koreanVoice;
      }

      speechSynthesis.speak(utterance);
    }

    // ë¶„ì„ ì´ˆê¸°í™” í•¨ìˆ˜
    function resetAnalysis() {
      fileInput.value = '';
      analyzeBtn.disabled = true;
      statusText.textContent = '';
      statusText.style.color = '#666';
      resultSection.classList.add('hidden');
      stopTTS(); // TTS ì •ì§€
      stopVoiceRecording(); // ìŒì„± ë…¹ìŒ ì¤‘ì§€
      currentSituation = null; // ìƒí™© ì •ë³´ ì´ˆê¸°í™”
      const questionAnswer = document.getElementById('questionAnswer');
      if (questionAnswer) {
        questionAnswer.classList.add('hidden');
      }
      mainCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ìŒì„± ì¸ì‹ ì´ˆê¸°í™”
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initSpeechRecognition);
    } else {
      initSpeechRecognition();
    }
  </script>
</body>
</html>
